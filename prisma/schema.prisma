generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id    String @id @db.VarChar(40)
  email String @unique @db.VarChar(100)

  first_name String @db.VarChar(30)
  last_name  String @db.VarChar(70)

  profile_picture String? @db.VarChar(40)

  Subjects   Subject[]
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
}

model Subject {
  id             String  @id @db.VarChar(40)
  name           String  @db.VarChar(20)
  required       Boolean
  required_grade Int     @db.UnsignedTinyInt
  records        Int?    @db.UnsignedTinyInt
  user_id        String  @db.VarChar(40)

  User              User                @relation(fields: [user_id], references: [id])
  Assignments       Assignment[]
  Documents          DocumentToSubject[]
  Records             Record[]
}

model Assignment {
  id          String @id @db.VarChar(40)
  subject_id  String @db.VarChar(40)
  document_id String @db.VarChar(40)

  grade Int @db.UnsignedTinyInt

  record_id String? @db.VarChar(40)

  Record    Record?   @relation(fields: [record_id], references: [id])
  Subject  Subject  @relation(fields: [subject_id], references: [id])
  Document Document @relation(fields: [document_id], references: [id])
}

model DocumentToSubject {
  id          String  @id @db.VarChar(40)
  subject_id  String @db.VarChar(40)
  document_id String  @db.VarChar(40)

  subject  Subject @relation(fields: [subject_id], references: [id])
  document Document @relation(fields: [document_id], references: [id])
}

model Document {
  id          String              @id @db.VarChar(40)
  picture_id    String              @db.VarChar(40)
  description String              @db.Text
  Subjects    DocumentToSubject[]
  Assignment  Assignment[]
}

model Record {
  id         String @id @db.VarChar(40)
  grade     Int    @db.UnsignedTinyInt
  subject_id String @db.VarChar(40)

  Subject    Subject      @relation(fields: [subject_id], references: [id])
  Assignment Assignment[]
}
